{"paragraphs":[{"text":"%md\n# Manipuler correctement la distribution dans Spark\n> Nous sommes dans un centre de distribution.\n> Pour chaque client, nous devons livrer des produits dans les différentes villes de chaque région.   \n> Nous souhaitons connaître le poids total de produits distribués pour chaque client.","dateUpdated":"2016-12-14T11:31:36+0000","config":{"tableHide":false,"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481715096720_2134899940","id":"20161213-222707_1355014043","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Manipuler correctement la distribution dans Spark</h1>\n<blockquote><p>Nous sommes dans un centre de distribution.\n<br  />Pour chaque client, nous devons livrer des produits dans les différentes villes de chaque région.\n<br  />Nous souhaitons connaître le poids total de produits distribués pour chaque client.</p>\n</blockquote>\n"},"dateCreated":"2016-12-14T11:31:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:103"},{"title":"Chargement des villes","text":"val villes = Vector(\"Paris\",\"Marseille\",\"Lyon\",\"Toulouse\",\"Nice\",\"Nantes\",\"Strasbourg\",\"Montpellier\",\"Bordeaux\",\"Lille\",\"Rennes\",\"Reims\",\"Le Havre\",\"Saint-Étienne\",\"Toulon\",\"Grenoble\",\"Dijon\",\"Angers\",\"Nîmes\",\"Villeurbanne\",\"Saint-Denis\",\"Le Mans\",\"Clermont-Ferrand\",\"Aix-en-Provence\",\"Brest\",\"Limoges\",\"Tours\",\"Amiens\",\"Perpignan\",\"Metz\",\"Boulogne-Billancourt\",\"Besançon\",\"Orléans\",\"Rouen\",\"Mulhouse\",\"Caen\",\"Saint-Denis\",\"Nancy\",\"Argenteuil\",\"Saint-Paul\",\"Montreuil\",\"Roubaix\",\"Tourcoing\",\"Dunkerque\",\"Nanterre\",\"Créteil\",\"Avignon\",\"Vitry-sur-Seine\",\"Poitiers\",\"Courbevoie\",\"Fort-de-France\",\"Versailles\",\"Colombes\",\"Asnières-sur-Seine\",\"Aulnay-sous-Bois\",\"Saint-Pierre\",\"Rueil-Malmaison\",\"Pau\",\"Aubervilliers\",\"Champigny-sur-Marne\",\"Le Tampon\",\"Antibes\",\"Saint-Maur-des-Fossés\",\"La Rochelle\",\"Cannes\",\"Béziers\",\"Calais\",\"Saint-Nazaire\",\"Colmar\",\"Drancy\",\"Bourges\",\"Mérignac\",\"Ajaccio\",\"Issy-les-Moulineaux\",\"Levallois-Perret\",\"La Seyne-sur-Mer\",\"Quimper\",\"Noisy-le-Grand\",\"Valence\",\"Villeneuve-d'Ascq\",\"Neuilly-sur-Seine\",\"Antony\",\"Vénissieux\",\"Cergy\",\"Troyes\",\"Clichy\",\"Pessac\",\"Les Abymes\",\"Ivry-sur-Seine\",\"Chambéry\",\"Lorient\",\"Niort\",\"Sarcelles\",\"Montauban\",\"Villejuif\",\"Saint-Quentin\",\"Hyères\",\"Cayenne\",\"Épinay-sur-Seine\",\"Saint-André\",\"Beauvais\",\"Maisons-Alfort\",\"Cholet\",\"Meaux\",\"Chelles\",\"Pantin\",\"Fontenay-sous-Bois\",\"La Roche-sur-Yon\",\"Bondy\",\"Vannes\",\"Saint-Louis\",\"Fréjus\",\"Arles\",\"Clamart\",\"Évry\",\"Le Blanc-Mesnil\",\"Narbonne\",\"Sartrouville\",\"Grasse\",\"Annecy\",\"Laval\",\"Belfort\",\"Vincennes\",\"Charleville-Mézières\",\"Évreux\",\"Sevran\",\"Albi\",\"Montrouge\",\"Bobigny\",\"Martigues\",\"Saint-Ouen\",\"Brive-la-Gaillarde\",\"Suresnes\",\"Carcassonne\",\"Cagnes-sur-Mer\",\"Corbeil-Essonnes\",\"Saint-Brieuc\",\"Blois\",\"Bayonne\",\"Aubagne\",\"Châlons-en-Champagne\",\"Meudon\",\"Châteauroux\",\"Saint-Malo\",\"Chalon-sur-Saône\",\"Sète\",\"Puteaux\",\"Alfortville\",\"Salon-de-Provence\",\"Massy\",\"Mantes-la-Jolie\",\"Bastia\",\"Vaulx-en-Velin\",\"Saint-Herblain\",\"Le Cannet\",\"Valenciennes\",\"Istres\",\"Gennevilliers\",\"Boulogne-sur-Mer\",\"Livry-Gargan\",\"Saint-Priest\",\"Rosny-sous-Bois\",\"Caluire-et-Cuire\",\"Angoulême\",\"Douai\",\"Tarbes\",\"Wattrelos\",\"Castres\",\"Choisy-le-Roi\",\"Talence\",\"Thionville\",\"Arras\",\"Alès\",\"Garges-lès-Gonesse\",\"Gap\",\"Saint-Laurent-du-Maroni\",\"Melun\",\"Bourg-en-Bresse\",\"Noisy-le-Sec\",\"Compiègne\",\"La Courneuve\",\"Le Lamentin\",\"Marcq-en-Barœul\",\"Saint-Germain-en-Laye\",\"Rezé\",\"Bron\",\"Anglet\",\"Gagny\",\"Chartres\",\"Bagneux\",\"Saint-Martin-d'Hères\",\"Montluçon\",\"Pontault-Combault\",\"Poissy\",\"Draguignan\",\"Joué-lès-Tours\",\"Savigny-sur-Orge\",\"Cherbourg-Octeville\",\"Saint-Joseph\",\"Le Port\",\"Colomiers\",\"Saint-Martin\",\"Villefranche-sur-Saône\",\"Stains\",\"Saint-Benoît\",\"Échirolles\",\"Villepinte\",\"Roanne\",\"Montélimar\",\"Saint-Chamond\",\"Nevers\",\"Conflans-Sainte-Honorine\",\"Auxerre\",\"Sainte-Geneviève-des-Bois\",\"Châtillon\",\"Bagnolet\",\"Vitrolles\",\"Thonon-les-Bains\",\"Neuilly-sur-Marne\",\"Haguenau\",\"Marignane\",\"Saint-Raphaël\",\"Tremblay-en-France\",\"La Ciotat\",\"Six-Fours-les-Plages\",\"Creil\",\"Agen\",\"Romans-sur-Isère\",\"Montigny-le-Bretonneux\",\"Le Perreux-sur-Marne\",\"Franconville\",\"Annemasse\",\"Villeneuve-Saint-Georges\",\"Saint-Leu\",\"Mâcon\",\"Cambrai\",\"Lens\",\"Houilles\",\"Épinal\",\"Châtenay-Malabry\",\"Schiltigheim\",\"Sainte-Marie\",\"Liévin\",\"Châtellerault\",\"Meyzieu\",\"Goussainville\",\"Viry-Châtillon\",\"Dreux\",\"L'Haÿ-les-Roses\",\"Plaisir\",\"Mont-de-Marsan\",\"Maubeuge\",\"Nogent-sur-Marne\",\"Les Mureaux\",\"Clichy-sous-Bois\",\"La Possession\",\"Dieppe\",\"Chatou\",\"Vandœuvre-lès-Nancy\",\"Malakoff\",\"Palaiseau\",\"Pontoise\",\"Charenton-le-Pont\",\"Rillieux-la-Pape\")","dateUpdated":"2016-12-16T01:07:03+0000","config":{"tableHide":true,"colWidth":12,"editorMode":"ace/mode/scala","editorHide":true,"title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481715096720_2134899940","id":"20161214-005233_1215405916","result":{"code":"SUCCESS","type":"TEXT","msg":"villes: scala.collection.immutable.Vector[String] = Vector(Paris, Marseille, Lyon, Toulouse, Nice, Nantes, Strasbourg, Montpellier, Bordeaux, Lille, Rennes, Reims, Le Havre, Saint-Étienne, Toulon, Grenoble, Dijon, Angers, Nîmes, Villeurbanne, Saint-Denis, Le Mans, Clermont-Ferrand, Aix-en-Provence, Brest, Limoges, Tours, Amiens, Perpignan, Metz, Boulogne-Billancourt, Besançon, Orléans, Rouen, Mulhouse, Caen, Saint-Denis, Nancy, Argenteuil, Saint-Paul, Montreuil, Roubaix, Tourcoing, Dunkerque, Nanterre, Créteil, Avignon, Vitry-sur-Seine, Poitiers, Courbevoie, Fort-de-France, Versailles, Colombes, Asnières-sur-Seine, Aulnay-sous-Bois, Saint-Pierre, Rueil-Malmaison, Pau, Aubervilliers, Champigny-sur-Marne, Le Tampon, Antibes, Saint-Maur-des-Fossés, La Rochelle, Cannes, Béziers, Calais, Sai..."},"dateCreated":"2016-12-14T11:31:36+0000","dateStarted":"2016-12-16T01:07:03+0000","dateFinished":"2016-12-16T01:07:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:104"},{"title":"Chargement des regions","text":"val regions = Vector(\"Île-de-France\",\"Provence-Alpes-Côte d'Azur\",\"Rhône-Alpes\",\"Midi-Pyrénées\",\"Provence-Alpes-Côte d'Azur\",\"Pays de la Loire\",\"Alsace\",\"Languedoc-Roussillon\",\"Aquitaine\",\"Nord-Pas-de-Calais\",\"Bretagne\",\"Champagne-Ardenne\",\"Haute-Normandie\",\"Rhône-Alpes\",\"Provence-Alpes-Côte d'Azur\",\"Rhône-Alpes\",\"Bourgogne\",\"Pays de la Loire\",\"Languedoc-Roussillon\",\"Rhône-Alpes\",\"La Réunion\",\"Pays de la Loire\",\"Auvergne\",\"Provence-Alpes-Côte d'Azur\",\"Bretagne\",\"Limousin\",\"Centre-Val de Loire\",\"Picardie\",\"Languedoc-Roussillon\",\"Lorraine\",\"Île-de-France\",\"Franche-Comté\",\"Centre-Val de Loire\",\"Haute-Normandie\",\"Alsace\",\"Basse-Normandie\",\"Île-de-France\",\"Lorraine\",\"Île-de-France\",\"La Réunion\",\"Île-de-France\",\"Nord-Pas-de-Calais\",\"Nord-Pas-de-Calais\",\"Nord-Pas-de-Calais\",\"Île-de-France\",\"Île-de-France\",\"Provence-Alpes-Côte d'Azur\",\"Île-de-France\",\"Poitou-Charentes\",\"Île-de-France\",\"Martinique\",\"Île-de-France\",\"Île-de-France\",\"Île-de-France\",\"Île-de-France\",\"La Réunion\",\"Île-de-France\",\"Aquitaine\",\"Île-de-France\",\"Île-de-France\",\"La Réunion\",\"Provence-Alpes-Côte d'Azur\",\"Île-de-France\",\"Poitou-Charentes\",\"Provence-Alpes-Côte d'Azur\",\"Languedoc-Roussillon\",\"Nord-Pas-de-Calais\",\"Pays de la Loire\",\"Alsace\",\"Île-de-France\",\"Centre-Val de Loire\",\"Aquitaine\",\"Corse\",\"Île-de-France\",\"Île-de-France\",\"Provence-Alpes-Côte d'Azur\",\"Bretagne\",\"Île-de-France\",\"Rhône-Alpes\",\"Nord-Pas-de-Calais\",\"Île-de-France\",\"Île-de-France\",\"Rhône-Alpes\",\"Île-de-France\",\"Champagne-Ardenne\",\"Île-de-France\",\"Aquitaine\",\"Guadeloupe\",\"Île-de-France\",\"Rhône-Alpes\",\"Bretagne\",\"Poitou-Charentes\",\"Île-de-France\",\"Midi-Pyrénées\",\"Île-de-France\",\"Picardie\",\"Provence-Alpes-Côte d'Azur\",\"Guyane\",\"Île-de-France\",\"La Réunion\",\"Picardie\",\"Île-de-France\",\"Pays de la Loire\",\"Île-de-France\",\"Île-de-France\",\"Île-de-France\",\"Île-de-France\",\"Pays de la Loire\",\"Île-de-France\",\"Bretagne\",\"La Réunion\",\"Provence-Alpes-Côte d'Azur\",\"Provence-Alpes-Côte d'Azur\",\"Île-de-France\",\"Île-de-France\",\"Île-de-France\",\"Languedoc-Roussillon\",\"Île-de-France\",\"Provence-Alpes-Côte d'Azur\",\"Rhône-Alpes\",\"Pays de la Loire\",\"Franche-Comté\",\"Île-de-France\",\"Champagne-Ardenne\",\"Haute-Normandie\",\"Île-de-France\",\"Midi-Pyrénées\",\"Île-de-France\",\"Île-de-France\",\"Provence-Alpes-Côte d'Azur\",\"Île-de-France\",\"Limousin\",\"Île-de-France\",\"Languedoc-Roussillon\",\"Provence-Alpes-Côte d'Azur\",\"Île-de-France\",\"Bretagne\",\"Centre-Val de Loire\",\"Aquitaine\",\"Provence-Alpes-Côte d'Azur\",\"Champagne-Ardenne\",\"Île-de-France\",\"Centre-Val de Loire\",\"Bretagne\",\"Bourgogne\",\"Languedoc-Roussillon\",\"Île-de-France\",\"Île-de-France\",\"Provence-Alpes-Côte d'Azur\",\"Île-de-France\",\"Île-de-France\",\"Corse\",\"Rhône-Alpes\",\"Pays de la Loire\",\"Provence-Alpes-Côte d'Azur\",\"Nord-Pas-de-Calais\",\"Provence-Alpes-Côte d'Azur\",\"Île-de-France\",\"Nord-Pas-de-Calais\",\"Île-de-France\",\"Rhône-Alpes\",\"Île-de-France\",\"Rhône-Alpes\",\"Poitou-Charentes\",\"Nord-Pas-de-Calais\",\"Midi-Pyrénées\",\"Nord-Pas-de-Calais\",\"Midi-Pyrénées\",\"Île-de-France\",\"Aquitaine\",\"Lorraine\",\"Nord-Pas-de-Calais\",\"Languedoc-Roussillon\",\"Île-de-France\",\"Provence-Alpes-Côte d'Azur\",\"Guyane\",\"Île-de-France\",\"Rhône-Alpes\",\"Île-de-France\",\"Picardie\",\"Île-de-France\",\"Martinique\",\"Nord-Pas-de-Calais\",\"Île-de-France\",\"Pays de la Loire\",\"Rhône-Alpes\",\"Aquitaine\",\"Île-de-France\",\"Centre-Val de Loire\",\"Île-de-France\",\"Rhône-Alpes\",\"Auvergne\",\"Île-de-France\",\"Île-de-France\",\"Provence-Alpes-Côte d'Azur\",\"Centre-Val de Loire\",\"Île-de-France\",\"Basse-Normandie\",\"La Réunion\",\"La Réunion\",\"Midi-Pyrénées\",\"\",\"Rhône-Alpes\",\"Île-de-France\",\"La Réunion\",\"Rhône-Alpes\",\"Île-de-France\",\"Rhône-Alpes\",\"Rhône-Alpes\",\"Rhône-Alpes\",\"Bourgogne\",\"Île-de-France\",\"Bourgogne\",\"Île-de-France\",\"Île-de-France\",\"Île-de-France\",\"Provence-Alpes-Côte d'Azur\",\"Rhône-Alpes\",\"Île-de-France\",\"Alsace\",\"Provence-Alpes-Côte d'Azur\",\"Provence-Alpes-Côte d'Azur\",\"Île-de-France\",\"Provence-Alpes-Côte d'Azur\",\"Provence-Alpes-Côte d'Azur\",\"Picardie\",\"Aquitaine\",\"Rhône-Alpes\",\"Île-de-France\",\"Île-de-France\",\"Île-de-France\",\"Rhône-Alpes\",\"Île-de-France\",\"La Réunion\",\"Bourgogne\",\"Nord-Pas-de-Calais\",\"Nord-Pas-de-Calais\",\"Île-de-France\",\"Lorraine\",\"Île-de-France\",\"Alsace\",\"La Réunion\",\"Nord-Pas-de-Calais\",\"Poitou-Charentes\",\"Rhône-Alpes\",\"Île-de-France\",\"Île-de-France\",\"Centre-Val de Loire\",\"Île-de-France\",\"Île-de-France\",\"Aquitaine\",\"Nord-Pas-de-Calais\",\"Île-de-France\",\"Île-de-France\",\"Île-de-France\",\"La Réunion\",\"Haute-Normandie\",\"Île-de-France\",\"Lorraine\",\"Île-de-France\",\"Île-de-France\",\"Île-de-France\",\"Île-de-France\",\"Rhône-Alpes\")","dateUpdated":"2016-12-16T01:07:35+0000","config":{"lineNumbers":false,"tableHide":true,"colWidth":12,"editorMode":"ace/mode/scala","editorHide":true,"title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481715096720_2134899940","id":"20161214-005709_1105455692","result":{"code":"SUCCESS","type":"TEXT","msg":"regions: scala.collection.immutable.Vector[String] = Vector(Île-de-France, Provence-Alpes-Côte d'Azur, Rhône-Alpes, Midi-Pyrénées, Provence-Alpes-Côte d'Azur, Pays de la Loire, Alsace, Languedoc-Roussillon, Aquitaine, Nord-Pas-de-Calais, Bretagne, Champagne-Ardenne, Haute-Normandie, Rhône-Alpes, Provence-Alpes-Côte d'Azur, Rhône-Alpes, Bourgogne, Pays de la Loire, Languedoc-Roussillon, Rhône-Alpes, La Réunion, Pays de la Loire, Auvergne, Provence-Alpes-Côte d'Azur, Bretagne, Limousin, Centre-Val de Loire, Picardie, Languedoc-Roussillon, Lorraine, Île-de-France, Franche-Comté, Centre-Val de Loire, Haute-Normandie, Alsace, Basse-Normandie, Île-de-France, Lorraine, Île-de-France, La Réunion, Île-de-France, Nord-Pas-de-Calais, Nord-Pas-de-Calais, Nord-Pas-de-Calais, Île-de-France, Île-de-Fr..."},"dateCreated":"2016-12-14T11:31:36+0000","dateStarted":"2016-12-16T01:07:35+0000","dateFinished":"2016-12-16T01:07:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:105"},{"title":"Chargement des clients","text":"val retailers = Vector(\"Aldi\",\"Auchan\", \"Amazon\",\"Bricomarché\",\"Casino\",\"Carrefour\",\"Carrefour Market\",\"Champion\",\"Colruyt\",\"Cora\",\"E.Leclerc\",\"Écomarché\",\"Franprix\",\"Géant\",\"Hypercacher\",\"Hyper U\",\"Inno\",\"Intermarché\",\"Le Relais des Mousquetaires\",\"Leader Price\",\"LIDL\",\"Marché Plus\",\"Marché U\",\"Monoprix\",\"Netto\",\"Roady\",\"Simply Market\",\"Spar\",\"Super U\",\"Supermarchés G20\",\"Utile\",\"Vêti\",\"Vival\")","dateUpdated":"2016-12-16T01:07:47+0000","config":{"tableHide":false,"colWidth":12,"editorMode":"ace/mode/scala","editorHide":true,"title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481715096720_2134899940","id":"20161214-005855_418585238","result":{"code":"SUCCESS","type":"TEXT","msg":"\nretailers: scala.collection.immutable.Vector[String] = Vector(Aldi, Auchan, Amazon, Bricomarché, Casino, Carrefour, Carrefour Market, Champion, Colruyt, Cora, E.Leclerc, Écomarché, Franprix, Géant, Hypercacher, Hyper U, Inno, Intermarché, Le Relais des Mousquetaires, Leader Price, LIDL, Marché Plus, Marché U, Monoprix, Netto, Roady, Simply Market, Spar, Super U, Supermarchés G20, Utile, Vêti, Vival)\n"},"dateCreated":"2016-12-14T11:31:36+0000","dateStarted":"2016-12-16T01:07:38+0000","dateFinished":"2016-12-16T01:07:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:106"},{"title":"Définition des produits ","text":"case class Product(id:Int, weight:Int, retailer:String, city:String, region:String) \nval rnd = new scala.util.Random \ndef getRndBias(min:Int, max:Int, bias:Int, influence:Double):Int = {\n    val x = min + rnd.nextInt( (max - min) + 1 )\n    val mix = rnd.nextDouble * influence           \n    math.ceil(x * (1 - mix) + bias * mix).toInt    \n}\ndef getRndMode(min:Int, max:Int, mode:Int, influence:Double):Int = {\n    if(rnd.nextDouble > influence)\n        min + rnd.nextInt( (max - min) + 1 )\n    else mode\n}\ndef generateProduct(selectRetailer:Int = 0,selectCity:Int = 0,selectId:Int = 0,selectWeight:Int = 0,retailerInfluence:Double = 0.0, cityInfluence:Double = 0.0, idInfluence:Double = 0.0, weightInfluence:Double = 0.0):Product = {\n    val r = getRndMode(0,32,selectRetailer,retailerInfluence)\n    val v = getRndMode(0,263,selectCity,cityInfluence)\n    val id = getRndBias(1,10000,selectId,idInfluence)\n    val poids = getRndBias(1,200,selectWeight,weightInfluence)\n    Product(id, poids, retailers(r), villes(v), regions(v))\n}","dateUpdated":"2016-12-16T01:08:02+0000","config":{"tableHide":true,"colWidth":12,"editorMode":"ace/mode/scala","editorHide":true,"title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481715096721_2134515191","id":"20161214-010356_1105992846","result":{"code":"SUCCESS","type":"TEXT","msg":"\ndefined class Product\n\nrnd: scala.util.Random = scala.util.Random@9bdfbf3\n\ngetRndBias: (min: Int, max: Int, bias: Int, influence: Double)Int\n\ngetRndMode: (min: Int, max: Int, mode: Int, influence: Double)Int\n\ngenerateProduct: (selectRetailer: Int, selectCity: Int, selectId: Int, selectWeight: Int, retailerInfluence: Double, cityInfluence: Double, idInfluence: Double, weightInfluence: Double)Product\n"},"dateCreated":"2016-12-14T11:31:36+0000","dateStarted":"2016-12-16T01:08:02+0000","dateFinished":"2016-12-16T01:08:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:107"},{"text":"%md\n## Nous allons distribuer quelques produits \n> - 1 millons de produits aléatoires\n> - Avec une distribution homogéne tant pour les clients, villes, régions, poids et quantités distribuées.\n> - Essayons de trouver le poids total de produits par client","dateUpdated":"2016-12-14T11:33:58+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481715096721_2134515191","id":"20161214-014140_969312284","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Nous allons distribuer quelques produits</h2>\n<blockquote><ul>\n<li>1 millons de produits aléatoires</li>\n<li>Avec une distribution homogéne tant pour les clients, villes, régions, poids et quantités distribuées.</li>\n<li>Essayons de trouver le poids total de produits par client</li>\n</ul>\n</blockquote>\n"},"dateCreated":"2016-12-14T11:31:36+0000","dateStarted":"2016-12-14T11:33:58+0000","dateFinished":"2016-12-14T11:33:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:108"},{"title":"Génération des produits","text":"val productsRDD = sc.parallelize(for(i <- 0 to 1000000) yield generateProduct(),6)\nval productsDF = spark.createDataFrame(productsRDD)\nproductsDF.createOrReplaceTempView(\"products\") ","dateUpdated":"2016-12-16T01:08:48+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481715096721_2134515191","id":"20161213-222800_663127995","result":{"code":"SUCCESS","type":"TEXT","msg":"\nproductsRDD: org.apache.spark.rdd.RDD[Product] = ParallelCollectionRDD[0] at parallelize at <console>:43\n\nproductsDF: org.apache.spark.sql.DataFrame = [id: int, weight: int ... 3 more fields]\n"},"dateCreated":"2016-12-14T11:31:36+0000","dateStarted":"2016-12-16T01:08:48+0000","dateFinished":"2016-12-16T01:08:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:109"},{"text":"%md\n> Nous allons prendre les clients comme clef de partitionament pour calculer de façon simple et en parallèle le poids total pour chaque client ","dateUpdated":"2016-12-14T11:31:36+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481715096721_2134515191","id":"20161214-095450_667747255","result":{"code":"SUCCESS","type":"HTML","msg":"<blockquote><p>Nous allons prendre les clients comme clef de partitionament pour calculer de façon simple et en parallèle le poids total pour chaque client</p>\n</blockquote>\n"},"dateCreated":"2016-12-14T11:31:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:110"},{"title":"Nous allons calculer la somme du poids total par client","text":"import org.apache.spark.SparkContext._\nproductsRDD.map(p => ((p.retailer,p.retailer), p.weight)).coalesce(numPartitions = 6, shuffle=true).groupByKey().map(p => p._1._2 -> p._2.sum).groupByKey().map(p => (p._1, p._2.sum)).collect()","dateUpdated":"2016-12-16T01:10:47+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481715096721_2134515191","id":"20161214-034748_1780312115","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.SparkContext._\n\nres7: Array[(String, Int)] = Array((Aldi,3025739), (Netto,3064542), (Franprix,3040527), (Roady,3034692), (Champion,3028979), (Vêti,3033284), (Carrefour Market,3024075), (Bricomarché,3071623), (Amazon,3047796), (Hypercacher,3033187), (Inno,3014652), (Leader Price,3006693), (Le Relais des Mousquetaires,3046523), (Super U,3060494), (Marché Plus,3030850), (Marché U,3055441), (Écomarché,3050901), (Carrefour,3045580), (E.Leclerc,3049687), (Hyper U,3027154), (Géant,3033003), (Supermarchés G20,3062077), (Spar,3055216), (Monoprix,3082372), (Simply Market,3048117), (Intermarché,3070126), (Auchan,3032946), (Vival,3029598), (Colruyt,3038029), (Utile,3060200), (Cora,3033426), (Casino,3070365), (LIDL,3057973))\n"},"dateCreated":"2016-12-14T11:31:36+0000","dateStarted":"2016-12-16T01:10:47+0000","dateFinished":"2016-12-16T01:10:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:111"},{"text":"%md\n## Le calcul est simple et nous nous retrouvons avec une distribution homogène \n### Le volume de données traitées par chaque worker est pratiquement le même\n\n> 0 | 192.168.56.51:40034 | 2 s | 2 | 1756.2 KB / 364103\n> 1 | 192.168.56.52:47320 | 2 s | 2 | 1426.1 KB / 303371\n> 2 | 192.168.56.53:50049 | 2 s | 2 | 1627.1 KB / 332527\n\n0\t192.168.56.51:38674\t2 s\t2\t0\t2\t2.7 MB / 272503\t416.0 B / 9\n1\t192.168.56.53:39073\t3 s\t2\t0\t2\t3.4 MB / 333687\t492.0 B / 11\n2\t192.168.56.52:58458\t2 s\t2\t0\t2\t4.0 MB / 393811\t539.0 B / 13\n\n### Notre cluster est efficace !","dateUpdated":"2016-12-14T11:35:26+0000","config":{"tableHide":false,"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481715096721_2134515191","id":"20161214-013119_135206558","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Le calcul est simple et nous nous retrouvons avec une distribution homogène</h2>\n<h3>Le volume de données traitées par chaque worker est pratiquement le même</h3>\n<blockquote><p>0 | 192.168.56.51:40034 | 2 s | 2 | 1756.2 KB / 364103\n<br  />1 | 192.168.56.52:47320 | 2 s | 2 | 1426.1 KB / 303371\n<br  />2 | 192.168.56.53:50049 | 2 s | 2 | 1627.1 KB / 332527</p>\n</blockquote>\n<h3>Notre cluster est efficace !</h3>\n"},"dateCreated":"2016-12-14T11:31:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112"},{"title":"Regardons les resultats","text":"%sql\nSELECT retailer, SUM(weight) AS totalWeight FROM products GROUP BY retailer","dateUpdated":"2016-12-16T01:15:46+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","editorHide":true,"title":true,"graph":{"mode":"pieChart","height":300,"optionOpen":false,"keys":[{"name":"retailer","index":0,"aggr":"sum"}],"values":[{"name":"totalWeight","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"retailer","index":0,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481715096721_2134515191","id":"20161214-012912_1313510939","result":{"code":"SUCCESS","type":"TABLE","msg":"retailer\ttotalWeight\nInno\t3014652\nSimply Market\t3048117\nLIDL\t3057973\nMonoprix\t3082372\nHypercacher\t3033187\nLe Relais des Mousquetaires\t3046523\nNetto\t3064542\nBricomarché\t3071623\nCarrefour\t3045580\nE.Leclerc\t3049687\nGéant\t3033003\nFranprix\t3040527\nAldi\t3025739\nMarché U\t3055441\nHyper U\t3027154\nVival\t3029598\nÉcomarché\t3050901\nCarrefour Market\t3024075\nChampion\t3028979\nSpar\t3055216\nLeader Price\t3006693\nCasino\t3070365\nCora\t3033426\nColruyt\t3038029\nUtile\t3060200\nAuchan\t3032946\nVêti\t3033284\nMarché Plus\t3030850\nIntermarché\t3070126\nSupermarchés G20\t3062077\nSuper U\t3060494\nAmazon\t3047796\nRoady\t3034692\n","comment":"","msgTable":[[{"key":"totalWeight","value":"Inno"},{"key":"totalWeight","value":"3014652"}],[{"value":"Simply Market"},{"value":"3048117"}],[{"value":"LIDL"},{"value":"3057973"}],[{"value":"Monoprix"},{"value":"3082372"}],[{"value":"Hypercacher"},{"value":"3033187"}],[{"value":"Le Relais des Mousquetaires"},{"value":"3046523"}],[{"value":"Netto"},{"value":"3064542"}],[{"value":"Bricomarché"},{"value":"3071623"}],[{"value":"Carrefour"},{"value":"3045580"}],[{"value":"E.Leclerc"},{"value":"3049687"}],[{"value":"Géant"},{"value":"3033003"}],[{"value":"Franprix"},{"value":"3040527"}],[{"value":"Aldi"},{"value":"3025739"}],[{"value":"Marché U"},{"value":"3055441"}],[{"value":"Hyper U"},{"value":"3027154"}],[{"value":"Vival"},{"value":"3029598"}],[{"value":"Écomarché"},{"value":"3050901"}],[{"value":"Carrefour Market"},{"value":"3024075"}],[{"value":"Champion"},{"value":"3028979"}],[{"value":"Spar"},{"value":"3055216"}],[{"value":"Leader Price"},{"value":"3006693"}],[{"value":"Casino"},{"value":"3070365"}],[{"value":"Cora"},{"value":"3033426"}],[{"value":"Colruyt"},{"value":"3038029"}],[{"value":"Utile"},{"value":"3060200"}],[{"value":"Auchan"},{"value":"3032946"}],[{"value":"Vêti"},{"value":"3033284"}],[{"value":"Marché Plus"},{"value":"3030850"}],[{"value":"Intermarché"},{"value":"3070126"}],[{"value":"Supermarchés G20"},{"value":"3062077"}],[{"value":"Super U"},{"value":"3060494"}],[{"value":"Amazon"},{"value":"3047796"}],[{"value":"Roady"},{"value":"3034692"}]],"columnNames":[{"name":"retailer","index":0,"aggr":"sum"},{"name":"totalWeight","index":1,"aggr":"sum"}],"rows":[["Inno","3014652"],["Simply Market","3048117"],["LIDL","3057973"],["Monoprix","3082372"],["Hypercacher","3033187"],["Le Relais des Mousquetaires","3046523"],["Netto","3064542"],["Bricomarché","3071623"],["Carrefour","3045580"],["E.Leclerc","3049687"],["Géant","3033003"],["Franprix","3040527"],["Aldi","3025739"],["Marché U","3055441"],["Hyper U","3027154"],["Vival","3029598"],["Écomarché","3050901"],["Carrefour Market","3024075"],["Champion","3028979"],["Spar","3055216"],["Leader Price","3006693"],["Casino","3070365"],["Cora","3033426"],["Colruyt","3038029"],["Utile","3060200"],["Auchan","3032946"],["Vêti","3033284"],["Marché Plus","3030850"],["Intermarché","3070126"],["Supermarchés G20","3062077"],["Super U","3060494"],["Amazon","3047796"],["Roady","3034692"]]},"dateCreated":"2016-12-14T11:31:36+0000","dateStarted":"2016-12-16T01:15:30+0000","dateFinished":"2016-12-16T01:15:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:113"},{"text":"%md\n## Le marché évolue \n> - Un distributeur commence à conquerir le marché\n> - Quel est l'impact sur la distribution (dans le cluster ! ) ?\n> - Quid de l'efficacité du cluster ?","dateUpdated":"2016-12-14T11:31:36+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481715096721_2134515191","id":"20161214-025448_733253922","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Le marché évolue</h2>\n<blockquote><ul>\n<li>Un distributeur commence à conquerir le marché</li>\n<li>Quel est l'impact sur la distribution (dans le cluster ! ) ?</li>\n<li>Quid de l'efficacité du cluster ?</li>\n</ul>\n</blockquote>\n"},"dateCreated":"2016-12-14T11:31:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:114"},{"title":"Modifions la liste des produits avec une répartition différente (70% du marche pour Amazon) ","text":"val productsRDD = sc.parallelize(for(i <- 0 to 1000000) yield generateProduct(selectRetailer = 2,retailerInfluence = 0.7 ), 6) \nval productsDF = spark.createDataFrame(productsRDD)\nproductsDF.createOrReplaceTempView(\"products\")","dateUpdated":"2016-12-16T01:16:39+0000","config":{"colWidth":12,"title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481715096721_2134515191","id":"20161214-023021_1484316386","result":{"code":"SUCCESS","type":"TEXT","msg":"\nproductsRDD: org.apache.spark.rdd.RDD[Product] = ParallelCollectionRDD[18] at parallelize at <console>:46\n\nproductsDF: org.apache.spark.sql.DataFrame = [id: int, weight: int ... 3 more fields]\n"},"dateCreated":"2016-12-14T11:31:36+0000","dateStarted":"2016-12-16T01:16:39+0000","dateFinished":"2016-12-16T01:16:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:115"},{"title":"Nous allons réaliser la même somme","text":"import org.apache.spark.SparkContext._\nproductsRDD.map(p => ((p.retailer,p.retailer), p.weight)).coalesce(numPartitions = 6, shuffle=true).groupByKey().map(p => p._1._2 -> p._2.sum).groupByKey().map(p => (p._1, p._2.sum)).collect()","dateUpdated":"2016-12-16T01:17:05+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481715096721_2134515191","id":"20161214-035241_1739429110","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.SparkContext._\n\nres11: Array[(String, Int)] = Array((Aldi,918769), (Netto,913733), (Franprix,911374), (Roady,896462), (Champion,925801), (Vêti,921311), (Carrefour Market,916918), (Bricomarché,919817), (Amazon,71374489), (Hypercacher,920574), (Inno,904625), (Leader Price,909551), (Le Relais des Mousquetaires,921654), (Super U,911301), (Marché Plus,891531), (Marché U,906369), (Écomarché,880588), (Carrefour,933624), (E.Leclerc,907336), (Géant,894132), (Hyper U,916359), (Supermarchés G20,896917), (Spar,906870), (Monoprix,914629), (Simply Market,911281), (Intermarché,898241), (Auchan,910398), (Vival,916197), (Colruyt,904498), (Utile,928427), (Cora,925291), (Casino,922648), (LIDL,915914))\n"},"dateCreated":"2016-12-14T11:31:36+0000","dateStarted":"2016-12-16T01:17:05+0000","dateFinished":"2016-12-16T01:17:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:116"},{"text":"%md\n## Un exécuteur est utilisé 5x plus que le reste \n\n0\t192.168.56.51:38674\t1 s\t2\t0\t2\t5.3 MB / 781782\t408.0 B / 9\n1\t192.168.56.53:39073\t0.7 s\t2\t0\t2\t1323.1 KB / 118224\t526.0 B / 13\n2\t192.168.56.52:58458\t0.5 s\t2\t0\t2\t1122.9 KB / 99995\t481.0 B / 11\n\n> 0 |\t192.168.56.51:40034 |\t0.7 s |\t2 |\t**2.6 MB / 799709**\n> 1 |\t192.168.56.52:47320 |\t0.4 s |\t2 |\t427.3 KB / 90858\n> 2 |\t192.168.56.53:50049 |\t0.5 s |\t2 |\t528.6 KB / 109434\n\n### L'exécuteur ralentit le cluster, il met 50% de plus de temps pour finir le traitement et liberer le cluster. Cela peut vous retarder de plusieurs heures","dateUpdated":"2016-12-16T01:17:00+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481715096721_2134515191","id":"20161214-043846_2103687412","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Un exécuteur est utilisé 5x plus que le reste</h2>\n<blockquote><p>0 |   192.168.56.51:40034 |   0.7 s | 2 | <strong>2.6 MB / 799709</strong>\n<br  />1 |   192.168.56.52:47320 |   0.4 s | 2 | 427.3 KB / 90858\n<br  />2 |   192.168.56.53:50049 |   0.5 s | 2 | 528.6 KB / 109434</p>\n</blockquote>\n<h3>L'exécuteur ralentit le cluster, il met 50% de plus de temps pour finir le traitement et liberer le cluster. Cela peut vous retarder de plusieurs heures</h3>\n"},"dateCreated":"2016-12-14T11:31:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:117"},{"title":"Regardons les résultats","text":"%sql\nSELECT retailer, SUM(weight) AS totalWeight FROM products GROUP BY retailer","dateUpdated":"2016-12-16T01:32:27+0000","config":{"colWidth":12,"editorHide":false,"title":true,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"retailer","index":0,"aggr":"sum"}],"values":[{"name":"totalWeight","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"retailer","index":0,"aggr":"sum"},"yAxis":{"name":"totalWeight","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481715096721_2134515191","id":"20161214-031355_463780619","result":{"code":"SUCCESS","type":"TABLE","msg":"retailer\ttotalWeight\nInno\t904625\nSimply Market\t911281\nLIDL\t915914\nMonoprix\t914629\nLe Relais des Mousquetaires\t921654\nHypercacher\t920574\nNetto\t913733\nBricomarché\t919817\nCarrefour\t933624\nE.Leclerc\t907336\nGéant\t894132\nFranprix\t911374\nAldi\t918769\nMarché U\t906369\nHyper U\t916359\nVival\t916197\nÉcomarché\t880588\nCarrefour Market\t916918\nChampion\t925801\nSpar\t906870\nLeader Price\t909551\nCasino\t922648\nCora\t925291\nColruyt\t904498\nUtile\t928427\nAuchan\t910398\nVêti\t921311\nMarché Plus\t891531\nIntermarché\t898241\nSupermarchés G20\t896917\nSuper U\t911301\nAmazon\t71374489\nRoady\t896462\n","comment":"","msgTable":[[{"key":"totalWeight","value":"Inno"},{"key":"totalWeight","value":"904625"}],[{"value":"Simply Market"},{"value":"911281"}],[{"value":"LIDL"},{"value":"915914"}],[{"value":"Monoprix"},{"value":"914629"}],[{"value":"Le Relais des Mousquetaires"},{"value":"921654"}],[{"value":"Hypercacher"},{"value":"920574"}],[{"value":"Netto"},{"value":"913733"}],[{"value":"Bricomarché"},{"value":"919817"}],[{"value":"Carrefour"},{"value":"933624"}],[{"value":"E.Leclerc"},{"value":"907336"}],[{"value":"Géant"},{"value":"894132"}],[{"value":"Franprix"},{"value":"911374"}],[{"value":"Aldi"},{"value":"918769"}],[{"value":"Marché U"},{"value":"906369"}],[{"value":"Hyper U"},{"value":"916359"}],[{"value":"Vival"},{"value":"916197"}],[{"value":"Écomarché"},{"value":"880588"}],[{"value":"Carrefour Market"},{"value":"916918"}],[{"value":"Champion"},{"value":"925801"}],[{"value":"Spar"},{"value":"906870"}],[{"value":"Leader Price"},{"value":"909551"}],[{"value":"Casino"},{"value":"922648"}],[{"value":"Cora"},{"value":"925291"}],[{"value":"Colruyt"},{"value":"904498"}],[{"value":"Utile"},{"value":"928427"}],[{"value":"Auchan"},{"value":"910398"}],[{"value":"Vêti"},{"value":"921311"}],[{"value":"Marché Plus"},{"value":"891531"}],[{"value":"Intermarché"},{"value":"898241"}],[{"value":"Supermarchés G20"},{"value":"896917"}],[{"value":"Super U"},{"value":"911301"}],[{"value":"Amazon"},{"value":"71374489"}],[{"value":"Roady"},{"value":"896462"}]],"columnNames":[{"name":"retailer","index":0,"aggr":"sum"},{"name":"totalWeight","index":1,"aggr":"sum"}],"rows":[["Inno","904625"],["Simply Market","911281"],["LIDL","915914"],["Monoprix","914629"],["Le Relais des Mousquetaires","921654"],["Hypercacher","920574"],["Netto","913733"],["Bricomarché","919817"],["Carrefour","933624"],["E.Leclerc","907336"],["Géant","894132"],["Franprix","911374"],["Aldi","918769"],["Marché U","906369"],["Hyper U","916359"],["Vival","916197"],["Écomarché","880588"],["Carrefour Market","916918"],["Champion","925801"],["Spar","906870"],["Leader Price","909551"],["Casino","922648"],["Cora","925291"],["Colruyt","904498"],["Utile","928427"],["Auchan","910398"],["Vêti","921311"],["Marché Plus","891531"],["Intermarché","898241"],["Supermarchés G20","896917"],["Super U","911301"],["Amazon","71374489"],["Roady","896462"]]},"dateCreated":"2016-12-14T11:31:36+0000","dateStarted":"2016-12-16T01:32:27+0000","dateFinished":"2016-12-16T01:32:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:118"},{"text":"%md\nNous allons partionner par region puis par client","dateUpdated":"2016-12-14T11:40:26+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481715096721_2134515191","id":"20161214-102651_1741368520","result":{"code":"SUCCESS","type":"HTML","msg":"<p>Nous allons partionner par region puis par client</p>\n"},"dateCreated":"2016-12-14T11:31:36+0000","dateStarted":"2016-12-14T11:40:21+0000","dateFinished":"2016-12-14T11:40:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:119"},{"text":"import org.apache.spark.SparkContext._\nproductsRDD.map(p => ((p.region,p.retailer), p.weight)).coalesce(numPartitions = 6, shuffle=true).groupByKey().map(p => p._1._2 -> p._2.sum).groupByKey().map(p => (p._1, p._2.sum)).collect()","dateUpdated":"2016-12-16T01:20:41+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481715544176_-1397480833","id":"20161214-113904_1565553478","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.SparkContext._\n\nres13: Array[(String, Int)] = Array((Aldi,918769), (Netto,913733), (Franprix,911374), (Roady,896462), (Champion,925801), (Vêti,921311), (Carrefour Market,916918), (Bricomarché,919817), (Amazon,71374489), (Hypercacher,920574), (Inno,904625), (Leader Price,909551), (Le Relais des Mousquetaires,921654), (Super U,911301), (Marché Plus,891531), (Marché U,906369), (Écomarché,880588), (Carrefour,933624), (E.Leclerc,907336), (Géant,894132), (Hyper U,916359), (Supermarchés G20,896917), (Spar,906870), (Monoprix,914629), (Simply Market,911281), (Intermarché,898241), (Auchan,910398), (Vival,916197), (Colruyt,904498), (Cora,925291), (Utile,928427), (Casino,922648), (LIDL,915914))\n"},"dateCreated":"2016-12-14T11:39:04+0000","dateStarted":"2016-12-16T01:20:41+0000","dateFinished":"2016-12-16T01:20:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:120"},{"text":"%md\n\n0\t192.168.56.51:38674\t1 s\t2\t0\t2\t5.1 MB / 540052\t2.9 KB / 307\n1\t192.168.56.53:39073\t0.9 s\t2\t0\t2\t2.2 MB / 207393\t2.7 KB / 289\n2\t192.168.56.52:58458\t1.0 s\t2\t0\t2\t2.7 MB / 252556\t2.8 KB / 295\n\n","dateUpdated":"2016-12-14T11:44:08+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481715634828_245551857","id":"20161214-114034_1725966242","result":{"code":"SUCCESS","type":"HTML","msg":"<p>0   192.168.56.51:38674 1 s 2   0   2   5.1 MB / 540052 2.9 KB / 307\n<br  />1   192.168.56.53:39073 0.9 s   2   0   2   2.2 MB / 207393 2.7 KB / 289\n<br  />2   192.168.56.52:58458 1.0 s   2   0   2   2.7 MB / 252556 2.8 KB / 295</p>\n"},"dateCreated":"2016-12-14T11:40:34+0000","dateStarted":"2016-12-14T11:44:08+0000","dateFinished":"2016-12-14T11:44:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:121"},{"text":"%md\nNous allons partionner par ville puis par client","dateUpdated":"2016-12-14T11:44:10+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481715820615_1215563486","id":"20161214-114340_1127674287","result":{"code":"SUCCESS","type":"HTML","msg":"<p>Nous allons partionner par ville puis par client</p>\n"},"dateCreated":"2016-12-14T11:43:40+0000","dateStarted":"2016-12-14T11:44:10+0000","dateFinished":"2016-12-14T11:44:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:122"},{"text":"import org.apache.spark.SparkContext._\nproductsRDD.map(p => ((p.city,p.retailer), p.weight)).coalesce(numPartitions = 6, shuffle=true).groupByKey().map(p => p._1._2 -> p._2.sum).groupByKey().map(p => (p._1, p._2.sum)).collect()","dateUpdated":"2016-12-16T01:23:57+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481715096723_2135284689","id":"20161214-060050_511600136","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.SparkContext._\n\nres15: Array[(String, Int)] = Array((Aldi,918769), (Netto,913733), (Franprix,911374), (Roady,896462), (Champion,925801), (Vêti,921311), (Carrefour Market,916918), (Bricomarché,919817), (Amazon,71374489), (Hypercacher,920574), (Inno,904625), (Leader Price,909551), (Le Relais des Mousquetaires,921654), (Super U,911301), (Marché Plus,891531), (Marché U,906369), (Écomarché,880588), (Carrefour,933624), (E.Leclerc,907336), (Hyper U,916359), (Géant,894132), (Supermarchés G20,896917), (Spar,906870), (Monoprix,914629), (Simply Market,911281), (Intermarché,898241), (Auchan,910398), (Vival,916197), (Colruyt,904498), (Utile,928427), (Cora,925291), (Casino,922648), (LIDL,915914))\n"},"dateCreated":"2016-12-14T11:31:36+0000","dateStarted":"2016-12-16T01:23:57+0000","dateFinished":"2016-12-16T01:24:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:123"},{"text":"%md\n## Cette strategie d'evolution permet d'optimiser notre cluster pour tenir compte de l'évolution du marché\n\n> 0\t| 192.168.56.51:40034 |\t0.2 s |\t2 | 1560.0 B / 72\n> 1\t| 192.168.56.52:47320 |\t0.2 s |\t2 | 1398.0 B / 60\n> 2 | 192.168.56.53:50049 |\t0.2 s |\t2 | 1500.0 B / 66\n\n0\t192.168.56.51:38674\t0.7 s\t2\t0\t2\t3.7 MB / 294492\t15.0 KB / 2860\n1\t192.168.56.53:39073\t0.8 s\t2\t0\t2\t4.2 MB / 338955\t15.3 KB / 2917\n2\t192.168.56.52:58458\t0.8 s\t2\t0\t2\t4.6 MB / 366554\t15.1 KB / 2902\n\n#Conclusion\n\nIl est important de connaitre ses données pour optimiser les règles de distributions ","dateUpdated":"2016-12-16T01:24:36+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481715096723_2135284689","id":"20161214-061446_496965706","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Sans clef de distribution ou plutot avec un cles de distribution aléatoire le cluster récupere ça capacité</h2>\n<blockquote><p>0 | 192.168.56.51:40034 | 0.2 s | 2 | 1560.0 B / 72\n<br  />1 | 192.168.56.52:47320 | 0.2 s | 2 | 1398.0 B / 60\n<br  />2 | 192.168.56.53:50049 | 0.2 s | 2 | 1500.0 B / 66</p>\n</blockquote>\n"},"dateCreated":"2016-12-14T11:31:36+0000","dateStarted":"2016-12-14T11:37:14+0000","dateFinished":"2016-12-14T11:37:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:124"},{"text":"","dateUpdated":"2016-12-14T11:31:36+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481715096723_2135284689","id":"20161214-112944_52414874","dateCreated":"2016-12-14T11:31:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:125"}],"name":"Demo Reactive live","id":"2C4KFU4EC","angularObjects":{"2C4EZD9WF:shared_process":[],"2C3M7RAP1:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}