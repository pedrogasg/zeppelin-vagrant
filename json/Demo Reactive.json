{"paragraphs":[{"text":"%md\n# Manipuler correctement la distribution dans Spark\n> Nous sommes dans un centre de distribution.\n> Pour chaque client, nous devons livrer des produits dans les différentes villes de chaque région.   \n> Nous souhaitons connaître le poids total de produits distribués pour chaque client.","dateUpdated":"2016-12-14T09:43:06+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481668027392_-305632827","id":"20161213-222707_1355014043","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Manipuler correctement la distribution dans Spark</h1>\n<blockquote><p>Nous sommes dans un centre de distribution.\n<br  />Pour chaque client, nous devons livrer des produits dans les différentes villes de chaque région.\n<br  />Nous souhaitons connaître le poids total de produits distribués pour chaque client.</p>\n</blockquote>\n"},"dateCreated":"2016-12-13T10:27:07+0000","dateStarted":"2016-12-14T09:43:02+0000","dateFinished":"2016-12-14T09:43:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:386"},{"title":"Chargement des villes","text":"val villes = Vector(\"Paris\",\"Marseille\",\"Lyon\",\"Toulouse\",\"Nice\",\"Nantes\",\"Strasbourg\",\"Montpellier\",\"Bordeaux\",\"Lille\",\"Rennes\",\"Reims\",\"Le Havre\",\"Saint-Étienne\",\"Toulon\",\"Grenoble\",\"Dijon\",\"Angers\",\"Nîmes\",\"Villeurbanne\",\"Saint-Denis\",\"Le Mans\",\"Clermont-Ferrand\",\"Aix-en-Provence\",\"Brest\",\"Limoges\",\"Tours\",\"Amiens\",\"Perpignan\",\"Metz\",\"Boulogne-Billancourt\",\"Besançon\",\"Orléans\",\"Rouen\",\"Mulhouse\",\"Caen\",\"Saint-Denis\",\"Nancy\",\"Argenteuil\",\"Saint-Paul\",\"Montreuil\",\"Roubaix\",\"Tourcoing\",\"Dunkerque\",\"Nanterre\",\"Créteil\",\"Avignon\",\"Vitry-sur-Seine\",\"Poitiers\",\"Courbevoie\",\"Fort-de-France\",\"Versailles\",\"Colombes\",\"Asnières-sur-Seine\",\"Aulnay-sous-Bois\",\"Saint-Pierre\",\"Rueil-Malmaison\",\"Pau\",\"Aubervilliers\",\"Champigny-sur-Marne\",\"Le Tampon\",\"Antibes\",\"Saint-Maur-des-Fossés\",\"La Rochelle\",\"Cannes\",\"Béziers\",\"Calais\",\"Saint-Nazaire\",\"Colmar\",\"Drancy\",\"Bourges\",\"Mérignac\",\"Ajaccio\",\"Issy-les-Moulineaux\",\"Levallois-Perret\",\"La Seyne-sur-Mer\",\"Quimper\",\"Noisy-le-Grand\",\"Valence\",\"Villeneuve-d'Ascq\",\"Neuilly-sur-Seine\",\"Antony\",\"Vénissieux\",\"Cergy\",\"Troyes\",\"Clichy\",\"Pessac\",\"Les Abymes\",\"Ivry-sur-Seine\",\"Chambéry\",\"Lorient\",\"Niort\",\"Sarcelles\",\"Montauban\",\"Villejuif\",\"Saint-Quentin\",\"Hyères\",\"Cayenne\",\"Épinay-sur-Seine\",\"Saint-André\",\"Beauvais\",\"Maisons-Alfort\",\"Cholet\",\"Meaux\",\"Chelles\",\"Pantin\",\"Fontenay-sous-Bois\",\"La Roche-sur-Yon\",\"Bondy\",\"Vannes\",\"Saint-Louis\",\"Fréjus\",\"Arles\",\"Clamart\",\"Évry\",\"Le Blanc-Mesnil\",\"Narbonne\",\"Sartrouville\",\"Grasse\",\"Annecy\",\"Laval\",\"Belfort\",\"Vincennes\",\"Charleville-Mézières\",\"Évreux\",\"Sevran\",\"Albi\",\"Montrouge\",\"Bobigny\",\"Martigues\",\"Saint-Ouen\",\"Brive-la-Gaillarde\",\"Suresnes\",\"Carcassonne\",\"Cagnes-sur-Mer\",\"Corbeil-Essonnes\",\"Saint-Brieuc\",\"Blois\",\"Bayonne\",\"Aubagne\",\"Châlons-en-Champagne\",\"Meudon\",\"Châteauroux\",\"Saint-Malo\",\"Chalon-sur-Saône\",\"Sète\",\"Puteaux\",\"Alfortville\",\"Salon-de-Provence\",\"Massy\",\"Mantes-la-Jolie\",\"Bastia\",\"Vaulx-en-Velin\",\"Saint-Herblain\",\"Le Cannet\",\"Valenciennes\",\"Istres\",\"Gennevilliers\",\"Boulogne-sur-Mer\",\"Livry-Gargan\",\"Saint-Priest\",\"Rosny-sous-Bois\",\"Caluire-et-Cuire\",\"Angoulême\",\"Douai\",\"Tarbes\",\"Wattrelos\",\"Castres\",\"Choisy-le-Roi\",\"Talence\",\"Thionville\",\"Arras\",\"Alès\",\"Garges-lès-Gonesse\",\"Gap\",\"Saint-Laurent-du-Maroni\",\"Melun\",\"Bourg-en-Bresse\",\"Noisy-le-Sec\",\"Compiègne\",\"La Courneuve\",\"Le Lamentin\",\"Marcq-en-Barœul\",\"Saint-Germain-en-Laye\",\"Rezé\",\"Bron\",\"Anglet\",\"Gagny\",\"Chartres\",\"Bagneux\",\"Saint-Martin-d'Hères\",\"Montluçon\",\"Pontault-Combault\",\"Poissy\",\"Draguignan\",\"Joué-lès-Tours\",\"Savigny-sur-Orge\",\"Cherbourg-Octeville\",\"Saint-Joseph\",\"Le Port\",\"Colomiers\",\"Saint-Martin\",\"Villefranche-sur-Saône\",\"Stains\",\"Saint-Benoît\",\"Échirolles\",\"Villepinte\",\"Roanne\",\"Montélimar\",\"Saint-Chamond\",\"Nevers\",\"Conflans-Sainte-Honorine\",\"Auxerre\",\"Sainte-Geneviève-des-Bois\",\"Châtillon\",\"Bagnolet\",\"Vitrolles\",\"Thonon-les-Bains\",\"Neuilly-sur-Marne\",\"Haguenau\",\"Marignane\",\"Saint-Raphaël\",\"Tremblay-en-France\",\"La Ciotat\",\"Six-Fours-les-Plages\",\"Creil\",\"Agen\",\"Romans-sur-Isère\",\"Montigny-le-Bretonneux\",\"Le Perreux-sur-Marne\",\"Franconville\",\"Annemasse\",\"Villeneuve-Saint-Georges\",\"Saint-Leu\",\"Mâcon\",\"Cambrai\",\"Lens\",\"Houilles\",\"Épinal\",\"Châtenay-Malabry\",\"Schiltigheim\",\"Sainte-Marie\",\"Liévin\",\"Châtellerault\",\"Meyzieu\",\"Goussainville\",\"Viry-Châtillon\",\"Dreux\",\"L'Haÿ-les-Roses\",\"Plaisir\",\"Mont-de-Marsan\",\"Maubeuge\",\"Nogent-sur-Marne\",\"Les Mureaux\",\"Clichy-sous-Bois\",\"La Possession\",\"Dieppe\",\"Chatou\",\"Vandœuvre-lès-Nancy\",\"Malakoff\",\"Palaiseau\",\"Pontoise\",\"Charenton-le-Pont\",\"Rillieux-la-Pape\")","dateUpdated":"2016-12-14T09:52:07+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":true,"tableHide":true,"title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481676753449_-58402990","id":"20161214-005233_1215405916","result":{"code":"SUCCESS","type":"TEXT","msg":"villes: scala.collection.immutable.Vector[String] = Vector(Paris, Marseille, Lyon, Toulouse, Nice, Nantes, Strasbourg, Montpellier, Bordeaux, Lille, Rennes, Reims, Le Havre, Saint-Étienne, Toulon, Grenoble, Dijon, Angers, Nîmes, Villeurbanne, Saint-Denis, Le Mans, Clermont-Ferrand, Aix-en-Provence, Brest, Limoges, Tours, Amiens, Perpignan, Metz, Boulogne-Billancourt, Besançon, Orléans, Rouen, Mulhouse, Caen, Saint-Denis, Nancy, Argenteuil, Saint-Paul, Montreuil, Roubaix, Tourcoing, Dunkerque, Nanterre, Créteil, Avignon, Vitry-sur-Seine, Poitiers, Courbevoie, Fort-de-France, Versailles, Colombes, Asnières-sur-Seine, Aulnay-sous-Bois, Saint-Pierre, Rueil-Malmaison, Pau, Aubervilliers, Champigny-sur-Marne, Le Tampon, Antibes, Saint-Maur-des-Fossés, La Rochelle, Cannes, Béziers, Calais, Sai..."},"dateCreated":"2016-12-14T12:52:33+0000","dateStarted":"2016-12-14T09:30:07+0000","dateFinished":"2016-12-14T09:30:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:387"},{"title":"Chargement des regions","text":"val regions = Vector(\"Île-de-France\",\"Provence-Alpes-Côte d'Azur\",\"Rhône-Alpes\",\"Midi-Pyrénées\",\"Provence-Alpes-Côte d'Azur\",\"Pays de la Loire\",\"Alsace\",\"Languedoc-Roussillon\",\"Aquitaine\",\"Nord-Pas-de-Calais\",\"Bretagne\",\"Champagne-Ardenne\",\"Haute-Normandie\",\"Rhône-Alpes\",\"Provence-Alpes-Côte d'Azur\",\"Rhône-Alpes\",\"Bourgogne\",\"Pays de la Loire\",\"Languedoc-Roussillon\",\"Rhône-Alpes\",\"La Réunion\",\"Pays de la Loire\",\"Auvergne\",\"Provence-Alpes-Côte d'Azur\",\"Bretagne\",\"Limousin\",\"Centre-Val de Loire\",\"Picardie\",\"Languedoc-Roussillon\",\"Lorraine\",\"Île-de-France\",\"Franche-Comté\",\"Centre-Val de Loire\",\"Haute-Normandie\",\"Alsace\",\"Basse-Normandie\",\"Île-de-France\",\"Lorraine\",\"Île-de-France\",\"La Réunion\",\"Île-de-France\",\"Nord-Pas-de-Calais\",\"Nord-Pas-de-Calais\",\"Nord-Pas-de-Calais\",\"Île-de-France\",\"Île-de-France\",\"Provence-Alpes-Côte d'Azur\",\"Île-de-France\",\"Poitou-Charentes\",\"Île-de-France\",\"Martinique\",\"Île-de-France\",\"Île-de-France\",\"Île-de-France\",\"Île-de-France\",\"La Réunion\",\"Île-de-France\",\"Aquitaine\",\"Île-de-France\",\"Île-de-France\",\"La Réunion\",\"Provence-Alpes-Côte d'Azur\",\"Île-de-France\",\"Poitou-Charentes\",\"Provence-Alpes-Côte d'Azur\",\"Languedoc-Roussillon\",\"Nord-Pas-de-Calais\",\"Pays de la Loire\",\"Alsace\",\"Île-de-France\",\"Centre-Val de Loire\",\"Aquitaine\",\"Corse\",\"Île-de-France\",\"Île-de-France\",\"Provence-Alpes-Côte d'Azur\",\"Bretagne\",\"Île-de-France\",\"Rhône-Alpes\",\"Nord-Pas-de-Calais\",\"Île-de-France\",\"Île-de-France\",\"Rhône-Alpes\",\"Île-de-France\",\"Champagne-Ardenne\",\"Île-de-France\",\"Aquitaine\",\"Guadeloupe\",\"Île-de-France\",\"Rhône-Alpes\",\"Bretagne\",\"Poitou-Charentes\",\"Île-de-France\",\"Midi-Pyrénées\",\"Île-de-France\",\"Picardie\",\"Provence-Alpes-Côte d'Azur\",\"Guyane\",\"Île-de-France\",\"La Réunion\",\"Picardie\",\"Île-de-France\",\"Pays de la Loire\",\"Île-de-France\",\"Île-de-France\",\"Île-de-France\",\"Île-de-France\",\"Pays de la Loire\",\"Île-de-France\",\"Bretagne\",\"La Réunion\",\"Provence-Alpes-Côte d'Azur\",\"Provence-Alpes-Côte d'Azur\",\"Île-de-France\",\"Île-de-France\",\"Île-de-France\",\"Languedoc-Roussillon\",\"Île-de-France\",\"Provence-Alpes-Côte d'Azur\",\"Rhône-Alpes\",\"Pays de la Loire\",\"Franche-Comté\",\"Île-de-France\",\"Champagne-Ardenne\",\"Haute-Normandie\",\"Île-de-France\",\"Midi-Pyrénées\",\"Île-de-France\",\"Île-de-France\",\"Provence-Alpes-Côte d'Azur\",\"Île-de-France\",\"Limousin\",\"Île-de-France\",\"Languedoc-Roussillon\",\"Provence-Alpes-Côte d'Azur\",\"Île-de-France\",\"Bretagne\",\"Centre-Val de Loire\",\"Aquitaine\",\"Provence-Alpes-Côte d'Azur\",\"Champagne-Ardenne\",\"Île-de-France\",\"Centre-Val de Loire\",\"Bretagne\",\"Bourgogne\",\"Languedoc-Roussillon\",\"Île-de-France\",\"Île-de-France\",\"Provence-Alpes-Côte d'Azur\",\"Île-de-France\",\"Île-de-France\",\"Corse\",\"Rhône-Alpes\",\"Pays de la Loire\",\"Provence-Alpes-Côte d'Azur\",\"Nord-Pas-de-Calais\",\"Provence-Alpes-Côte d'Azur\",\"Île-de-France\",\"Nord-Pas-de-Calais\",\"Île-de-France\",\"Rhône-Alpes\",\"Île-de-France\",\"Rhône-Alpes\",\"Poitou-Charentes\",\"Nord-Pas-de-Calais\",\"Midi-Pyrénées\",\"Nord-Pas-de-Calais\",\"Midi-Pyrénées\",\"Île-de-France\",\"Aquitaine\",\"Lorraine\",\"Nord-Pas-de-Calais\",\"Languedoc-Roussillon\",\"Île-de-France\",\"Provence-Alpes-Côte d'Azur\",\"Guyane\",\"Île-de-France\",\"Rhône-Alpes\",\"Île-de-France\",\"Picardie\",\"Île-de-France\",\"Martinique\",\"Nord-Pas-de-Calais\",\"Île-de-France\",\"Pays de la Loire\",\"Rhône-Alpes\",\"Aquitaine\",\"Île-de-France\",\"Centre-Val de Loire\",\"Île-de-France\",\"Rhône-Alpes\",\"Auvergne\",\"Île-de-France\",\"Île-de-France\",\"Provence-Alpes-Côte d'Azur\",\"Centre-Val de Loire\",\"Île-de-France\",\"Basse-Normandie\",\"La Réunion\",\"La Réunion\",\"Midi-Pyrénées\",\"\",\"Rhône-Alpes\",\"Île-de-France\",\"La Réunion\",\"Rhône-Alpes\",\"Île-de-France\",\"Rhône-Alpes\",\"Rhône-Alpes\",\"Rhône-Alpes\",\"Bourgogne\",\"Île-de-France\",\"Bourgogne\",\"Île-de-France\",\"Île-de-France\",\"Île-de-France\",\"Provence-Alpes-Côte d'Azur\",\"Rhône-Alpes\",\"Île-de-France\",\"Alsace\",\"Provence-Alpes-Côte d'Azur\",\"Provence-Alpes-Côte d'Azur\",\"Île-de-France\",\"Provence-Alpes-Côte d'Azur\",\"Provence-Alpes-Côte d'Azur\",\"Picardie\",\"Aquitaine\",\"Rhône-Alpes\",\"Île-de-France\",\"Île-de-France\",\"Île-de-France\",\"Rhône-Alpes\",\"Île-de-France\",\"La Réunion\",\"Bourgogne\",\"Nord-Pas-de-Calais\",\"Nord-Pas-de-Calais\",\"Île-de-France\",\"Lorraine\",\"Île-de-France\",\"Alsace\",\"La Réunion\",\"Nord-Pas-de-Calais\",\"Poitou-Charentes\",\"Rhône-Alpes\",\"Île-de-France\",\"Île-de-France\",\"Centre-Val de Loire\",\"Île-de-France\",\"Île-de-France\",\"Aquitaine\",\"Nord-Pas-de-Calais\",\"Île-de-France\",\"Île-de-France\",\"Île-de-France\",\"La Réunion\",\"Haute-Normandie\",\"Île-de-France\",\"Lorraine\",\"Île-de-France\",\"Île-de-France\",\"Île-de-France\",\"Île-de-France\",\"Rhône-Alpes\")","dateUpdated":"2016-12-14T09:52:11+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","lineNumbers":false,"title":true,"editorHide":true,"tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481677029748_-356585032","id":"20161214-005709_1105455692","result":{"code":"SUCCESS","type":"TEXT","msg":"regions: scala.collection.immutable.Vector[String] = Vector(Île-de-France, Provence-Alpes-Côte d'Azur, Rhône-Alpes, Midi-Pyrénées, Provence-Alpes-Côte d'Azur, Pays de la Loire, Alsace, Languedoc-Roussillon, Aquitaine, Nord-Pas-de-Calais, Bretagne, Champagne-Ardenne, Haute-Normandie, Rhône-Alpes, Provence-Alpes-Côte d'Azur, Rhône-Alpes, Bourgogne, Pays de la Loire, Languedoc-Roussillon, Rhône-Alpes, La Réunion, Pays de la Loire, Auvergne, Provence-Alpes-Côte d'Azur, Bretagne, Limousin, Centre-Val de Loire, Picardie, Languedoc-Roussillon, Lorraine, Île-de-France, Franche-Comté, Centre-Val de Loire, Haute-Normandie, Alsace, Basse-Normandie, Île-de-France, Lorraine, Île-de-France, La Réunion, Île-de-France, Nord-Pas-de-Calais, Nord-Pas-de-Calais, Nord-Pas-de-Calais, Île-de-France, Île-de-Fr..."},"dateCreated":"2016-12-14T12:57:09+0000","dateStarted":"2016-12-14T09:30:09+0000","dateFinished":"2016-12-14T09:30:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:388"},{"title":"Chargement des clients","text":"val retailers = Vector(\"Aldi\",\"Auchan\", \"Amazon\",\"Bricomarché\",\"Casino\",\"Carrefour\",\"Carrefour Market\",\"Champion\",\"Colruyt\",\"Cora\",\"E.Leclerc\",\"Écomarché\",\"Franprix\",\"Géant\",\"Hypercacher\",\"Hyper U\",\"Inno\",\"Intermarché\",\"Le Relais des Mousquetaires\",\"Leader Price\",\"LIDL\",\"Marché Plus\",\"Marché U\",\"Monoprix\",\"Netto\",\"Roady\",\"Simply Market\",\"Spar\",\"Super U\",\"Supermarchés G20\",\"Utile\",\"Vêti\",\"Vival\")","dateUpdated":"2016-12-14T09:52:29+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true,"editorHide":true,"tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481677135023_1302406253","id":"20161214-005855_418585238","result":{"code":"SUCCESS","type":"TEXT","msg":"\nretailers: scala.collection.immutable.Vector[String] = Vector(Aldi, Auchan, Amazon, Bricomarché, Casino, Carrefour, Carrefour Market, Champion, Colruyt, Cora, E.Leclerc, Écomarché, Franprix, Géant, Hypercacher, Hyper U, Inno, Intermarché, Le Relais des Mousquetaires, Leader Price, LIDL, Marché Plus, Marché U, Monoprix, Netto, Roady, Simply Market, Spar, Super U, Supermarchés G20, Utile, Vêti, Vival)\n"},"dateCreated":"2016-12-14T12:58:55+0000","dateStarted":"2016-12-14T09:30:20+0000","dateFinished":"2016-12-14T09:30:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:389"},{"title":"Définition des produits ","text":"case class Product(id:Int, weight:Int, retailer:String, city:String, region:String) \nval rnd = new scala.util.Random \ndef getRndBias(min:Int, max:Int, bias:Int, influence:Double):Int = {\n    val x = min + rnd.nextInt( (max - min) + 1 )\n    val mix = rnd.nextDouble * influence           \n    math.ceil(x * (1 - mix) + bias * mix).toInt    \n}\ndef getRndMode(min:Int, max:Int, mode:Int, influence:Double):Int = {\n    if(rnd.nextDouble > influence)\n        min + rnd.nextInt( (max - min) + 1 )\n    else mode\n}\ndef generateProduct(selectRetailer:Int = 0,selectCity:Int = 0,selectId:Int = 0,selectWeight:Int = 0,retailerInfluence:Double = 0.0, cityInfluence:Double = 0.0, idInfluence:Double = 0.0, weightInfluence:Double = 0.0):Product = {\n    val r = getRndMode(0,32,selectRetailer,retailerInfluence)\n    val v = getRndMode(0,263,selectCity,cityInfluence)\n    val id = getRndBias(1,10000,selectId,idInfluence)\n    val poids = getRndBias(1,200,selectWeight,weightInfluence)\n    Product(id, poids, retailers(r), villes(v), regions(v))\n}","dateUpdated":"2016-12-14T09:51:08+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true,"editorHide":true,"tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481677436190_-1182072281","id":"20161214-010356_1105992846","result":{"code":"SUCCESS","type":"TEXT","msg":"\ndefined class Product\n\nrnd: scala.util.Random = scala.util.Random@9493188\n\ngetRndBias: (min: Int, max: Int, bias: Int, influence: Double)Int\n\ngetRndMode: (min: Int, max: Int, mode: Int, influence: Double)Int\n\ngenerateProduct: (selectRetailer: Int, selectCity: Int, selectId: Int, selectWeight: Int, retailerInfluence: Double, cityInfluence: Double, idInfluence: Double, weightInfluence: Double)Product\n"},"dateCreated":"2016-12-14T01:03:56+0000","dateStarted":"2016-12-14T09:30:21+0000","dateFinished":"2016-12-14T09:30:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:390"},{"text":"%md\n## Nous allons distribuer quelques produits \n> - 1 millons de produits aléatoires\n> - Avec une distribution homogéne tant pour les clients, villes, régions, poids et quantités distribuées.\n> - Essayons de trouver le poids total de produits par client","dateUpdated":"2016-12-14T09:48:46+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481679700121_1804195963","id":"20161214-014140_969312284","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Nous allons distribuer quelques produits</h2>\n<blockquote><ul>\n<li>1 millons de produits aléatoires</li>\n<li>Avec une distribution homogéne tant pour les clients, villes, régions, poids et quantités distribuées.</li>\n<li>Essayons de trouver le poids total de produits par client</li>\n</ul>\n</blockquote>\n"},"dateCreated":"2016-12-14T01:41:40+0000","dateStarted":"2016-12-14T09:48:43+0000","dateFinished":"2016-12-14T09:48:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:391"},{"title":"Génération des produits","text":"val productsRDD = sc.parallelize(for(i <- 0 to 1000000) yield generateProduct(),6)\nval productsDF = spark.createDataFrame(productsRDD)\nproductsDF.createOrReplaceTempView(\"products\") ","dateUpdated":"2016-12-14T09:49:47+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481668080165_-1243822500","id":"20161213-222800_663127995","result":{"code":"SUCCESS","type":"TEXT","msg":"\nproductsRDD: org.apache.spark.rdd.RDD[Product] = ParallelCollectionRDD[0] at parallelize at <console>:43\n\nproductsDF: org.apache.spark.sql.DataFrame = [id: int, weight: int ... 3 more fields]\n"},"dateCreated":"2016-12-13T10:28:00+0000","dateStarted":"2016-12-14T09:49:47+0000","dateFinished":"2016-12-14T09:49:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:392"},{"text":"%md\n> Nous allons prendre les clients comme clef de partitionament pour calculer de façon simple et en parallèle le poids total pour chaque client ","dateUpdated":"2016-12-14T10:26:38+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481709290744_194603840","id":"20161214-095450_667747255","result":{"code":"SUCCESS","type":"HTML","msg":"<blockquote><p>Nous allons prendre les clients comme clef de partitionament pour calculer de façon simple et en parallèle le poids total pour chaque client</p>\n</blockquote>\n"},"dateCreated":"2016-12-14T09:54:50+0000","dateStarted":"2016-12-14T10:04:40+0000","dateFinished":"2016-12-14T10:04:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:393"},{"title":"Nous allons calculer la somme du poids total par client","text":"productsRDD.map(p => (p.retailer, p.weight)).coalesce(numPartitions = 6, shuffle=true).groupByKey().map(p => (p._1,p._2.sum)).collect()","dateUpdated":"2016-12-14T10:00:40+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481687268053_-1354717047","id":"20161214-034748_1780312115","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres6: Array[(String, Int)] = Array((Aldi,3077857), (Netto,3037207), (Franprix,3059615), (Roady,3057135), (Champion,3067079), (Vêti,3053404), (Carrefour Market,3049808), (Bricomarché,2992715), (Amazon,3055250), (Hypercacher,3027306), (Inno,3074593), (Leader Price,3059916), (Le Relais des Mousquetaires,3026583), (Super U,3031698), (Marché Plus,3054232), (Marché U,3058801), (Écomarché,3019234), (Carrefour,3093135), (E.Leclerc,3046912), (Hyper U,3027706), (Géant,3042591), (Supermarchés G20,2998116), (Spar,3025493), (Monoprix,3087252), (Simply Market,3026158), (Intermarché,3037993), (Auchan,3062920), (Vival,3011589), (Colruyt,3038752), (Utile,3044102), (Cora,3033095), (Casino,3020848), (LIDL,3029193))\n"},"dateCreated":"2016-12-14T03:47:48+0000","dateStarted":"2016-12-14T10:00:40+0000","dateFinished":"2016-12-14T10:00:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:394"},{"text":"%md\n## Le calcul est simple et nous nous retrouvons avec une distribution homogène \n### Le volume de données traitées par chaque worker est pratiquement le même\n\n> 0 | 192.168.56.51:40034 | 2 s | 2 | 1756.2 KB / 364103\n> 1 | 192.168.56.52:47320 | 2 s | 2 | 1426.1 KB / 303371\n> 2 | 192.168.56.53:50049 | 2 s | 2 | 1627.1 KB / 332527\n\n### Notre cluster est efficace !","dateUpdated":"2016-12-14T10:05:06+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481679079507_-529811814","id":"20161214-013119_135206558","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Le calcul est simple et nous nous retrouvons avec une distribution homogène</h2>\n<h3>Le volume de données traitées par chaque worker est pratiquement le même</h3>\n<blockquote><p>0 | 192.168.56.51:40034 | 2 s | 2 | 1756.2 KB / 364103\n<br  />1 | 192.168.56.52:47320 | 2 s | 2 | 1426.1 KB / 303371\n<br  />2 | 192.168.56.53:50049 | 2 s | 2 | 1627.1 KB / 332527</p>\n</blockquote>\n<h3>Notre cluster est efficace !</h3>\n"},"dateCreated":"2016-12-14T01:31:19+0000","dateStarted":"2016-12-14T10:05:04+0000","dateFinished":"2016-12-14T10:05:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:395"},{"title":"Regardons les resultats","text":"%sql\nSELECT retailer, SUM(weight) AS totalWeight FROM products GROUP BY retailer","dateUpdated":"2016-12-14T10:07:22+0000","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"retailer","index":0,"aggr":"sum"}],"values":[{"name":"totalWeight","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"retailer","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","title":true,"editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481678952629_2070939154","id":"20161214-012912_1313510939","result":{"code":"SUCCESS","type":"TABLE","msg":"retailer\ttotalWeight\nInno\t3074593\nSimply Market\t3026158\nLIDL\t3029193\nMonoprix\t3087252\nHypercacher\t3027306\nLe Relais des Mousquetaires\t3026583\nBricomarché\t2992715\nNetto\t3037207\nCarrefour\t3093135\nE.Leclerc\t3046912\nGéant\t3042591\nFranprix\t3059615\nAldi\t3077857\nMarché U\t3058801\nHyper U\t3027706\nVival\t3011589\nÉcomarché\t3019234\nCarrefour Market\t3049808\nChampion\t3067079\nSpar\t3025493\nLeader Price\t3059916\nCasino\t3020848\nCora\t3033095\nColruyt\t3038752\nUtile\t3044102\nAuchan\t3062920\nVêti\t3053404\nMarché Plus\t3054232\nIntermarché\t3037993\nSupermarchés G20\t2998116\nSuper U\t3031698\nAmazon\t3055250\nRoady\t3057135\n","comment":"","msgTable":[[{"key":"totalWeight","value":"Inno"},{"key":"totalWeight","value":"3074593"}],[{"value":"Simply Market"},{"value":"3026158"}],[{"value":"LIDL"},{"value":"3029193"}],[{"value":"Monoprix"},{"value":"3087252"}],[{"value":"Hypercacher"},{"value":"3027306"}],[{"value":"Le Relais des Mousquetaires"},{"value":"3026583"}],[{"value":"Bricomarché"},{"value":"2992715"}],[{"value":"Netto"},{"value":"3037207"}],[{"value":"Carrefour"},{"value":"3093135"}],[{"value":"E.Leclerc"},{"value":"3046912"}],[{"value":"Géant"},{"value":"3042591"}],[{"value":"Franprix"},{"value":"3059615"}],[{"value":"Aldi"},{"value":"3077857"}],[{"value":"Marché U"},{"value":"3058801"}],[{"value":"Hyper U"},{"value":"3027706"}],[{"value":"Vival"},{"value":"3011589"}],[{"value":"Écomarché"},{"value":"3019234"}],[{"value":"Carrefour Market"},{"value":"3049808"}],[{"value":"Champion"},{"value":"3067079"}],[{"value":"Spar"},{"value":"3025493"}],[{"value":"Leader Price"},{"value":"3059916"}],[{"value":"Casino"},{"value":"3020848"}],[{"value":"Cora"},{"value":"3033095"}],[{"value":"Colruyt"},{"value":"3038752"}],[{"value":"Utile"},{"value":"3044102"}],[{"value":"Auchan"},{"value":"3062920"}],[{"value":"Vêti"},{"value":"3053404"}],[{"value":"Marché Plus"},{"value":"3054232"}],[{"value":"Intermarché"},{"value":"3037993"}],[{"value":"Supermarchés G20"},{"value":"2998116"}],[{"value":"Super U"},{"value":"3031698"}],[{"value":"Amazon"},{"value":"3055250"}],[{"value":"Roady"},{"value":"3057135"}]],"columnNames":[{"name":"retailer","index":0,"aggr":"sum"},{"name":"totalWeight","index":1,"aggr":"sum"}],"rows":[["Inno","3074593"],["Simply Market","3026158"],["LIDL","3029193"],["Monoprix","3087252"],["Hypercacher","3027306"],["Le Relais des Mousquetaires","3026583"],["Bricomarché","2992715"],["Netto","3037207"],["Carrefour","3093135"],["E.Leclerc","3046912"],["Géant","3042591"],["Franprix","3059615"],["Aldi","3077857"],["Marché U","3058801"],["Hyper U","3027706"],["Vival","3011589"],["Écomarché","3019234"],["Carrefour Market","3049808"],["Champion","3067079"],["Spar","3025493"],["Leader Price","3059916"],["Casino","3020848"],["Cora","3033095"],["Colruyt","3038752"],["Utile","3044102"],["Auchan","3062920"],["Vêti","3053404"],["Marché Plus","3054232"],["Intermarché","3037993"],["Supermarchés G20","2998116"],["Super U","3031698"],["Amazon","3055250"],["Roady","3057135"]]},"dateCreated":"2016-12-14T01:29:12+0000","dateStarted":"2016-12-14T10:06:25+0000","dateFinished":"2016-12-14T10:06:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:396"},{"text":"%md\n## Le marché évolue \n> - Un distributeur commence à conquerir le marché\n> - Quel est l'impact sur la distribution (dans le cluster ! ) ?\n> - Quid de l'efficacité du cluster ?","dateUpdated":"2016-12-14T10:13:21+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481684088903_-668473318","id":"20161214-025448_733253922","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Le marché évolue</h2>\n<blockquote><ul>\n<li>Un distributeur commence à conquerir le marché</li>\n<li>Quel est l'impact sur la distribution (dans le cluster ! ) ?</li>\n<li>Quid de l'efficacité du cluster ?</li>\n</ul>\n</blockquote>\n"},"dateCreated":"2016-12-14T02:54:48+0000","dateStarted":"2016-12-14T10:13:06+0000","dateFinished":"2016-12-14T10:13:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:397"},{"title":"Modifions la liste des produits avec une répartition différente (70% du marche pour Amazon) ","text":"val productsRDD = sc.parallelize(for(i <- 0 to 1000000) yield generateProduct(selectRetailer = 2,retailerInfluence = 0.7 ), 6) \nval productsDF = spark.createDataFrame(productsRDD)\nproductsDF.createOrReplaceTempView(\"products\")","dateUpdated":"2016-12-14T10:17:06+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"title":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481682621171_2009327597","id":"20161214-023021_1484316386","result":{"code":"SUCCESS","type":"TEXT","msg":"\nproductsRDD: org.apache.spark.rdd.RDD[Product] = ParallelCollectionRDD[16] at parallelize at <console>:43\n\nproductsDF: org.apache.spark.sql.DataFrame = [id: int, weight: int ... 3 more fields]\n"},"dateCreated":"2016-12-14T02:30:21+0000","dateStarted":"2016-12-14T10:17:06+0000","dateFinished":"2016-12-14T10:17:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:398"},{"title":"Nous allons réaliser la même somme","text":"productsRDD.map(p => (p.retailer, p.weight)).coalesce(numPartitions = 6, shuffle=true).groupByKey().map(p => (p._1,p._2.sum)).collect()","dateUpdated":"2016-12-14T11:31:28+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481687561412_151603900","id":"20161214-035241_1739429110","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres10: Array[(String, Int)] = Array((Aldi,908920), (Netto,921043), (Franprix,921610), (Roady,925543), (Champion,906287), (Vêti,926905), (Carrefour Market,919374), (Bricomarché,923293), (Amazon,71208345), (Hypercacher,920140), (Inno,907107), (Leader Price,904534), (Le Relais des Mousquetaires,923760), (Super U,906652), (Marché Plus,920985), (Marché U,906045), (Écomarché,919667), (Carrefour,925100), (E.Leclerc,916509), (Géant,917545), (Hyper U,901137), (Supermarchés G20,888937), (Spar,927936), (Monoprix,919069), (Simply Market,917946), (Intermarché,899029), (Auchan,916404), (Vival,904040), (Colruyt,918265), (Utile,919830), (Cora,911918), (Casino,907775), (LIDL,913363))\n"},"dateCreated":"2016-12-14T03:52:41+0000","dateStarted":"2016-12-14T10:17:35+0000","dateFinished":"2016-12-14T10:17:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:399"},{"text":"%md\n## Un exécuteur est utilisé 5x plus que le reste \n> 0 |\t192.168.56.51:40034 |\t0.7 s |\t2 |\t**2.6 MB / 799709**\n> 1 |\t192.168.56.52:47320 |\t0.4 s |\t2 |\t427.3 KB / 90858\n> 2 |\t192.168.56.53:50049 |\t0.5 s |\t2 |\t528.6 KB / 109434\n\n### L'exécuteur ralentit le cluster, il met 50% de plus de temps pour finir le traitement et liberer le cluster. Cela peut vous retarder de plusieurs heures","dateUpdated":"2016-12-14T10:22:20+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481690326608_-153946976","id":"20161214-043846_2103687412","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Un exécuteur est utilisé 5x plus que le reste</h2>\n<blockquote><p>0 |   192.168.56.51:40034 |   0.7 s | 2 | <strong>2.6 MB / 799709</strong>\n<br  />1 |   192.168.56.52:47320 |   0.4 s | 2 | 427.3 KB / 90858\n<br  />2 |   192.168.56.53:50049 |   0.5 s | 2 | 528.6 KB / 109434</p>\n</blockquote>\n<h3>L'exécuteur ralentit le cluster, il met 50% de plus de temps pour finir le traitement et liberer le cluster. Cela peut vous retarder de plusieurs heures</h3>\n"},"dateCreated":"2016-12-14T04:38:46+0000","dateStarted":"2016-12-14T10:22:18+0000","dateFinished":"2016-12-14T10:22:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:400"},{"title":"Regardons les résultats","text":"%sql\nSELECT retailer, SUM(weight) AS totalWeight FROM products GROUP BY retailer","dateUpdated":"2016-12-14T10:23:56+0000","config":{"colWidth":12,"graph":{"mode":"pieChart","height":300,"optionOpen":false,"keys":[{"name":"retailer","index":0,"aggr":"sum"}],"values":[{"name":"totalWeight","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"retailer","index":0,"aggr":"sum"},"yAxis":{"name":"totalWeight","index":1,"aggr":"sum"}}},"enabled":true,"title":true,"editorHide":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481685235268_571456372","id":"20161214-031355_463780619","result":{"code":"SUCCESS","type":"TABLE","msg":"retailer\ttotalWeight\nInno\t921876\nLIDL\t923904\nSimply Market\t908627\nMonoprix\t922625\nHypercacher\t919483\nLe Relais des Mousquetaires\t916093\nBricomarché\t932519\nNetto\t919028\nCarrefour\t920724\nE.Leclerc\t892969\nGéant\t919563\nFranprix\t922228\nAldi\t909073\nMarché U\t928336\nHyper U\t908352\nVival\t915319\nÉcomarché\t901884\nCarrefour Market\t923995\nChampion\t924339\nSpar\t926205\nLeader Price\t907404\nCasino\t915527\nCora\t915307\nColruyt\t913844\nUtile\t914194\nAuchan\t920831\nVêti\t927296\nMarché Plus\t905913\nIntermarché\t910173\nSupermarchés G20\t920019\nSuper U\t921182\nAmazon\t71233598\nRoady\t915929\n","comment":"","msgTable":[[{"key":"totalWeight","value":"Inno"},{"key":"totalWeight","value":"921876"}],[{"value":"LIDL"},{"value":"923904"}],[{"value":"Simply Market"},{"value":"908627"}],[{"value":"Monoprix"},{"value":"922625"}],[{"value":"Hypercacher"},{"value":"919483"}],[{"value":"Le Relais des Mousquetaires"},{"value":"916093"}],[{"value":"Bricomarché"},{"value":"932519"}],[{"value":"Netto"},{"value":"919028"}],[{"value":"Carrefour"},{"value":"920724"}],[{"value":"E.Leclerc"},{"value":"892969"}],[{"value":"Géant"},{"value":"919563"}],[{"value":"Franprix"},{"value":"922228"}],[{"value":"Aldi"},{"value":"909073"}],[{"value":"Marché U"},{"value":"928336"}],[{"value":"Hyper U"},{"value":"908352"}],[{"value":"Vival"},{"value":"915319"}],[{"value":"Écomarché"},{"value":"901884"}],[{"value":"Carrefour Market"},{"value":"923995"}],[{"value":"Champion"},{"value":"924339"}],[{"value":"Spar"},{"value":"926205"}],[{"value":"Leader Price"},{"value":"907404"}],[{"value":"Casino"},{"value":"915527"}],[{"value":"Cora"},{"value":"915307"}],[{"value":"Colruyt"},{"value":"913844"}],[{"value":"Utile"},{"value":"914194"}],[{"value":"Auchan"},{"value":"920831"}],[{"value":"Vêti"},{"value":"927296"}],[{"value":"Marché Plus"},{"value":"905913"}],[{"value":"Intermarché"},{"value":"910173"}],[{"value":"Supermarchés G20"},{"value":"920019"}],[{"value":"Super U"},{"value":"921182"}],[{"value":"Amazon"},{"value":"71233598"}],[{"value":"Roady"},{"value":"915929"}]],"columnNames":[{"name":"retailer","index":0,"aggr":"sum"},{"name":"totalWeight","index":1,"aggr":"sum"}],"rows":[["Inno","921876"],["LIDL","923904"],["Simply Market","908627"],["Monoprix","922625"],["Hypercacher","919483"],["Le Relais des Mousquetaires","916093"],["Bricomarché","932519"],["Netto","919028"],["Carrefour","920724"],["E.Leclerc","892969"],["Géant","919563"],["Franprix","922228"],["Aldi","909073"],["Marché U","928336"],["Hyper U","908352"],["Vival","915319"],["Écomarché","901884"],["Carrefour Market","923995"],["Champion","924339"],["Spar","926205"],["Leader Price","907404"],["Casino","915527"],["Cora","915307"],["Colruyt","913844"],["Utile","914194"],["Auchan","920831"],["Vêti","927296"],["Marché Plus","905913"],["Intermarché","910173"],["Supermarchés G20","920019"],["Super U","921182"],["Amazon","71233598"],["Roady","915929"]]},"dateCreated":"2016-12-14T03:13:55+0000","dateStarted":"2016-12-14T04:32:44+0000","dateFinished":"2016-12-14T04:32:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:401"},{"text":"%md\nNous allons demander  les clients comme clef de partitionament pour calculer de façon simple et en parallèle le poids total pour chaque client","dateUpdated":"2016-12-14T10:28:27+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481711211090_1446147684","id":"20161214-102651_1741368520","dateCreated":"2016-12-14T10:26:51+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:402"},{"text":"// productsRDD.map(p => (p.retailer, p.weight)).coalesce(numPartitions = 6, shuffle=true).groupByKey().map(p => (p._1,p._2.sum)).collect()\nproductsRDD.map(p => (p.retailer, p.weight)).coalesce(numPartitions = 6, shuffle=true).reduceByKey((x, y) => x + y).collect()","dateUpdated":"2016-12-14T10:26:07+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481695250578_2076123282","id":"20161214-060050_511600136","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres13: Array[(String, Int)] = Array((Aldi,898729), (Netto,920921), (Franprix,897781), (Roady,939265), (Champion,929500), (Vêti,913568), (Carrefour Market,919036), (Bricomarché,894590), (Amazon,71227599), (Hypercacher,910722), (Inno,923050), (Leader Price,918446), (Le Relais des Mousquetaires,910604), (Super U,909978), (Marché Plus,927205), (Marché U,908588), (Écomarché,929722), (Carrefour,910853), (E.Leclerc,927391), (Hyper U,918578), (Géant,908384), (Supermarchés G20,902523), (Spar,910793), (Monoprix,928490), (Simply Market,918279), (Intermarché,910774), (Auchan,921162), (Vival,894572), (Colruyt,907389), (Cora,898132), (Utile,917096), (Casino,924957), (LIDL,908175))\n"},"dateCreated":"2016-12-14T06:00:50+0000","dateStarted":"2016-12-14T06:16:51+0000","dateFinished":"2016-12-14T06:16:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:403"},{"text":"import org.apache.spark.SparkContext._\nproductsRDD.map(p => ((p.region,p.retailer),(p.retailer, p.weight))).coalesce(numPartitions = 6, shuffle=true).reduceByKey((x, y) => (x._1,x._2 + y._2)).map(x =>x._2 ).reduceByKey(_ + _).collect()","dateUpdated":"2016-12-14T11:10:55+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481711459125_-1442422296","id":"20161214-103059_1411368856","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.SparkContext._\n\nres46: Array[(String, Int)] = Array((Aldi,908920), (Netto,921043), (Franprix,921610), (Roady,925543), (Champion,906287), (Vêti,926905), (Carrefour Market,919374), (Bricomarché,923293), (Amazon,71208345), (Hypercacher,920140), (Inno,907107), (Leader Price,904534), (Le Relais des Mousquetaires,923760), (Super U,906652), (Marché Plus,920985), (Marché U,906045), (Écomarché,919667), (Carrefour,925100), (E.Leclerc,916509), (Hyper U,901137), (Géant,917545), (Supermarchés G20,888937), (Spar,927936), (Monoprix,919069), (Simply Market,917946), (Intermarché,899029), (Auchan,916404), (Vival,904040), (Colruyt,918265), (Cora,911918), (Utile,919830), (Casino,907775), (LIDL,913363))\n"},"dateCreated":"2016-12-14T10:30:59+0000","dateStarted":"2016-12-14T11:10:55+0000","dateFinished":"2016-12-14T11:10:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:404"},{"text":"productsRDD.map(p => ((p.retailer,p.retailer),(p.retailer, p.weight))).coalesce(numPartitions = 6, shuffle=false).reduceByKey((x, y) => (x._1,x._2 + y._2)).map(x =>x._2 ).reduceByKey(_ + _).collect()","dateUpdated":"2016-12-14T11:15:06+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481712492069_-219607093","id":"20161214-104812_1859347618","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres50: Array[(String, Int)] = Array((Aldi,908920), (Netto,921043), (Franprix,921610), (Roady,925543), (Champion,906287), (Vêti,926905), (Carrefour Market,919374), (Bricomarché,923293), (Amazon,71208345), (Hypercacher,920140), (Inno,907107), (Leader Price,904534), (Le Relais des Mousquetaires,923760), (Super U,906652), (Marché Plus,920985), (Marché U,906045), (Écomarché,919667), (Carrefour,925100), (E.Leclerc,916509), (Géant,917545), (Hyper U,901137), (Supermarchés G20,888937), (Spar,927936), (Monoprix,919069), (Simply Market,917946), (Intermarché,899029), (Auchan,916404), (Vival,904040), (Colruyt,918265), (Utile,919830), (Cora,911918), (Casino,907775), (LIDL,913363))\n"},"dateCreated":"2016-12-14T10:48:12+0000","dateStarted":"2016-12-14T11:15:06+0000","dateFinished":"2016-12-14T11:15:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:405"},{"text":"%md\n## Sans clef de distribution ou plutot avec un cles de distribution aléatoire le cluster récupere ça capacité\n\n> 0\t| 192.168.56.51:40034 |\t0.2 s |\t2 | 1560.0 B / 72\n> 1\t| 192.168.56.52:47320 |\t0.2 s |\t2 | 1398.0 B / 60\n> 2 | 192.168.56.53:50049 |\t0.2 s |\t2 | 1500.0 B / 66","dateUpdated":"2016-12-14T10:25:32+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481696086330_1200008998","id":"20161214-061446_496965706","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Sans cles de distribution ou plutot avec un cles de distribution aléatoire le cluster recupere ça capacité</h2>\n<blockquote><p>0 | 192.168.56.51:40034 | 0.2 s | 2 | 1560.0 B / 72\n<br  />1 | 192.168.56.52:47320 | 0.2 s | 2 | 1398.0 B / 60\n<br  />2 | 192.168.56.53:50049 | 0.2 s | 2 | 1500.0 B / 66</p>\n</blockquote>\n"},"dateCreated":"2016-12-14T06:14:46+0000","dateStarted":"2016-12-14T06:25:51+0000","dateFinished":"2016-12-14T06:25:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:406"},{"text":"\n\n//productsRDD.map(p => ((p.retailer,p.retailer),(p.retailer, p.weight))).coalesce(numPartitions = 6, shuffle=false).groupByKey().map(x => x. ).map(x =>x._2 ).reduceByKey(_ + _).collect()\nimport org.apache.spark.SparkContext._\nproductsRDD.map(p => ((p.region,p.retailer), p.weight)).coalesce(numPartitions = 6, shuffle=true).groupByKey().map(p => p._1._2 -> p._2.sum).groupByKey().map(p => (p._1, p._2.sum)).collect()","dateUpdated":"2016-12-14T11:28:15+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481696751943_-928957511","id":"20161214-062551_1606523703","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.SparkContext._\n\nres79: Array[(String, Int)] = Array((Aldi,908920), (Netto,921043), (Franprix,921610), (Roady,925543), (Champion,906287), (Vêti,926905), (Carrefour Market,919374), (Bricomarché,923293), (Amazon,71208345), (Hypercacher,920140), (Inno,907107), (Leader Price,904534), (Le Relais des Mousquetaires,923760), (Super U,906652), (Marché Plus,920985), (Marché U,906045), (Écomarché,919667), (Carrefour,925100), (E.Leclerc,916509), (Géant,917545), (Hyper U,901137), (Supermarchés G20,888937), (Spar,927936), (Monoprix,919069), (Simply Market,917946), (Intermarché,899029), (Auchan,916404), (Vival,904040), (Colruyt,918265), (Cora,911918), (Utile,919830), (Casino,907775), (LIDL,913363))\n"},"dateCreated":"2016-12-14T06:25:51+0000","dateStarted":"2016-12-14T11:28:16+0000","dateFinished":"2016-12-14T11:28:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:407"},{"text":"import org.apache.spark.SparkContext._\nproductsRDD.map(p => ((p.retailer,p.retailer), p.weight)).coalesce(numPartitions = 6, shuffle=true).groupByKey().map(p => p._1._2 -> p._2.sum).groupByKey().map(p => (p._1, p._2.sum)).collect()","dateUpdated":"2016-12-14T11:29:44+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481714494462_1191035911","id":"20161214-112134_900584621","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.SparkContext._\n\nres81: Array[(String, Int)] = Array((Aldi,908920), (Netto,921043), (Franprix,921610), (Roady,925543), (Champion,906287), (Vêti,926905), (Carrefour Market,919374), (Bricomarché,923293), (Amazon,71208345), (Hypercacher,920140), (Inno,907107), (Leader Price,904534), (Le Relais des Mousquetaires,923760), (Super U,906652), (Marché Plus,920985), (Marché U,906045), (Écomarché,919667), (Carrefour,925100), (E.Leclerc,916509), (Géant,917545), (Hyper U,901137), (Supermarchés G20,888937), (Spar,927936), (Monoprix,919069), (Simply Market,917946), (Intermarché,899029), (Auchan,916404), (Vival,904040), (Colruyt,918265), (Utile,919830), (Cora,911918), (Casino,907775), (LIDL,913363))\n"},"dateCreated":"2016-12-14T11:21:34+0000","dateStarted":"2016-12-14T11:29:44+0000","dateFinished":"2016-12-14T11:29:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:408"},{"text":"","dateUpdated":"2016-12-14T11:29:55+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481714984877_-106817363","id":"20161214-112944_52414874","dateCreated":"2016-12-14T11:29:44+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:409"}],"name":"Demo Reactive","id":"2C5NN9B5D","angularObjects":{"2C4EZD9WF:shared_process":[],"2C3M7RAP1:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}